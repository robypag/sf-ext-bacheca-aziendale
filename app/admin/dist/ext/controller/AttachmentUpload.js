sap.ui.define(["itg/sf/bachecaadmin/control/FileUploaderV4"],function(e){"use strict";return{onHandleFileDelete:function(e,t){if(t.length===0){var s=this._controller.oResourceBundle.getText("deleteMessageSelectEntry");new sap.m.MessageBox.show(s,{icon:sap.m.MessageBox.Icon.ERROR,title:"Error",actions:sap.m.MessageBox.Action.OK})}else{t.forEach(e=>{e.delete();var t=e.getObject().ID;fetch(`/admin/Attachments(ID=${t})`,{method:"DELETE"}).then(s=>{if(!s.ok){sap.m.MessageToast.show(`${s.status}-${s.statusText}`)}else{e.delete();e.refresh();sap.m.MessageToast.show(`Attachment ${t} deleted`)}})})}},onHandleFileUpload:function(t,s){var n=new e({useMultipart:false,uploadUrl:"/admin/Attachments",uploadComplete:function(e){sap.m.MessageToast.show(`Upload Completed!`);o.close()}});var a=new sap.m.VBox({width:"100%",alignItems:"Center",justifyContent:"Center",items:[n]});var o=new sap.m.Dialog({title:"Upload Attachment",type:sap.m.DialogType.Standard,content:a,beginButton:new sap.m.Button({text:"Upload",press:function(e){const s=n.oFileUpload.files[0];const a={name:s.name,mimeType:s.type||"text/plain",pubblication_ID:t.getObject().ID};fetch(`${n.getUploadUrl()}`,{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}}).then(e=>{if(!e.ok){throw new Error(`${e.status}-${e.statusText}`)}else{return e.json()}}).then(e=>{n.setUploadUrl(`${n.getUploadUrl()}(ID=${e.ID},IsActiveEntity=${e.IsActiveEntity})/value`);n.setSendXHR(true);n.upload()}).catch(e=>{sap.m.MessageToast.show(`Error: ${e}`)})}}),endButton:new sap.m.Button({text:"Cancel",press:function(e){o.close()}}),afterClose:function(){o.destroy();t.refresh()}});o.open()}}});